<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /GNE-Hospital-Management-System/api/

    # CORS Headers
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization, Access-Control-Allow-Headers, X-Requested-With"
    Header set Access-Control-Max-Age "3600"

    # Handle preflight requests
    RewriteCond %{REQUEST_METHOD} ^OPTIONS$ [NC]
    RewriteRule ^(.*)$ $1 [L]

    # Remove .php from URLs
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^auth/login$ auth/login.php [L]
    RewriteRule ^auth/logout$ auth/logout.php [L]
    RewriteRule ^employee/get_all$ employee/get_all.php [L]
    RewriteRule ^employee/get_doctors$ employee/get_doctors.php [L]
    RewriteRule ^employee/create$ employee/create.php [L]
    RewriteRule ^employee/update/(.*)$ employee/update.php [L]
    RewriteRule ^employee/delete/(.*)$ employee/delete.php [L]
    RewriteRule ^department/get_all$ department/get_all.php [L]
    RewriteRule ^department/create$ department/create.php [L]
    RewriteRule ^department/update/(.*)$ department/update.php [L]
    RewriteRule ^department/delete/(.*)$ department/delete.php [L]
    RewriteRule ^patient/get_all$ patient/get_all.php [L]
    RewriteRule ^patient/register$ patient/register.php [L]
    RewriteRule ^patient/update/(.*)$ patient/update.php [L]
    RewriteRule ^patient/delete/(.*)$ patient/delete.php [L]
    RewriteRule ^appointment/get_all$ appointment/get_all.php [L]
    RewriteRule ^appointment/book$ appointment/book.php [L]
    RewriteRule ^appointment/update/(.*)$ appointment/update.php [L]
    RewriteRule ^appointment/delete/(.*)$ appointment/delete.php [L]
    RewriteRule ^bed/get_all$ bed/get_all.php [L]
    RewriteRule ^bed/get_available$ bed/get_available.php [L]
    RewriteRule ^bed/update/(.*)$ bed/update.php [L]
    RewriteRule ^admission/get_all$ admission/get_all.php [L]
    RewriteRule ^admission/admit$ admission/admit.php [L]
    RewriteRule ^admission/update/(.*)$ admission/update.php [L]
    RewriteRule ^admission/discharge/(.*)$ admission/discharge.php [L]
    RewriteRule ^schedule/get_all$ schedule/get_all.php [L]
    RewriteRule ^schedule/create$ schedule/create.php [L]
    RewriteRule ^schedule/update/(.*)$ schedule/update.php [L]
    RewriteRule ^schedule/delete/(.*)$ schedule/delete.php [L]
    RewriteRule ^medical_record/get_all$ medical_record/get_all.php [L]
    RewriteRule ^medical_record/get/(.*)$ medical_record/get.php?id=$1 [L]
    RewriteRule ^medical_record/create$ medical_record/create.php [L]
    RewriteRule ^medical_record/update/(.*)$ medical_record/update.php [L]
    RewriteRule ^billing/get_all$ billing/get_all.php [L]
    RewriteRule ^billing/get_by_patient$ billing/get_by_patient.php [L]
    RewriteRule ^billing/create$ billing/create.php [L]
    RewriteRule ^billing/update_status$ billing/update_status.php [L]

    # Default: return 404 for non-mapped routes
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ - [R=404,L]
</IfModule>
